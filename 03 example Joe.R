library(psych)
library(corrplot)
# library(polyPK)

# Joe data
N250_low_diff <- c(-0.537918475, -0.504377486, 0.479777378, -0.410090113, -1.014447876, -0.271615674, 0.353497083, -0.325729984, -0.902574622, -0.219273350, 0.232601980, -0.199958631, -0.338112685, 0.536121913, 0.746629433, -0.326504787, -0.082608926, -0.415890702, -0.610149149, -0.461924069, -0.813310634, -0.117097414, 0.072072382, -0.121583487, -0.473631463, 0.540315604, 0.285479682, -0.673085192, -0.495072089, 0.109797103, 0.153598435, -0.909667627, 0.100581075, -0.264010979, -0.899994257, -0.262538119, -0.825763732, 0.708827051, -0.425089240)
N250_high_diff <- c(-0.5140683948, -0.0574726444, 0.1914482628, -0.4419769122, -0.3525042601, -0.4640665730, 0.3012443873, -0.5479529309, -0.3740059347, 0.4332861775, -0.0100874553, -0.5419890339, -0.2880176072, 0.1313640177, 0.7627634423, -0.3262494619, 0.0426262240, -0.4661439130, -0.3106525177, -0.5235559110, -0.2125073831, -0.1021337276, 0.1832846765, 0.3101476567, -0.5975446730, 0.6056279944, 0.2462143278, -0.5006812758, -0.3647360130, -0.0223939231, 0.2206622313, -1.2121112851, -0.1786671391, -0.4869138022, -1.0132498106, -0.0060798869, -1.3197496883, 1.0187780850, -0.1877477396)
N250_Joe_diff <- c(-0.853260526, -1.238520566, 0.528281033, 0.117930482, -0.699530733, 0.347836723, 0.598009167, -0.105370329, -1.713245674, -0.302882535, -0.772685952, -1.994420265, -0.689701918, -0.433409171, -0.218861333, 0.167269411, -0.743085625, -0.631725172, -1.418768470, -0.195129057, -0.702323667, 0.283871156, -0.360523120, 0.929679862, -0.271351181, 1.188115962, 0.376967538, -0.827467574, -1.640127125, 0.482731904, -0.629027739, -1.211373074, -0.301467548, -0.023659942, -1.401691124, -0.609328450, -0.615677070, 0.245136329, -1.726957643)
Easy <- c(1.258178633420120, 1.451051172256320, 1.122212669577160, 1.061341196887660, 1.315329671720720, 1.016012852721580, 1.227345017976160, 1.372654096317370, 0.766378876829247, 1.265725085119210, 0.650047615748275, 0.927975632935256, 1.052903100709970, 1.174942595808080, 0.851789096005431, 0.946681901349771, 1.262218703335240, 1.288519838353760, 1.314561395230220, 1.073007332643210, 1.315857099015160, 1.285983423927910, 1.046917945088380, 1.328726404885600, 1.144798757252930, 1.186335701703310, 0.970615459319835, 1.107676804477640, 1.232521851912960, 1.203590692415780, 0.935987957103511, 1.124293654394260, 1.125664404769610, 1.017395785573640, 1.179465997869350, 1.175620909432450, 1.168535409496850, 0.728808627274438, 1.272143786328750)
Hard <- c(0.80833333, 0.81666667, 0.64166667, 0.79166667, 0.62500000, 0.68333333, 0.84166667, 0.92500000, 0.80000000, 0.70000000, 0.69166667, 0.70833333, 0.71666667, 0.78333333, 0.63333333, 0.68333333, 0.70833333, 0.76666667, 0.87500000, 0.75000000, 0.75000000, 0.84166667, 0.80833333, 0.78333333, 0.71666667, 0.60000000, 0.80000000, 0.67500000, 0.70833333, 0.83333333, 0.73333333, 0.65833333, 0.73333333, 0.70833333, 0.78333333, 0.80833333, 0.76666667, 0.64166667, 0.65000000)
dat <- data.frame(N250_low_diff, N250_high_diff, N250_Joe_diff, Easy,Hard)

### Calculate for Joe data
N_perm=10000
s=1
  RR=c(cor(dat[,1],dat[,4]),cor(dat[,2],dat[,4]),cor(dat[,3],dat[,4]),cor(dat[,1],dat[,5]),cor(dat[,2],dat[,5]),cor(dat[,3],dat[,5]))
  T0=sort(RR,decreasing=FALSE)[s]
  T=c()
  for (sim in 1:N_perm)
  {
    dat_p=data.frame(N250_low_diff, sample(N250_high_diff), sample(N250_Joe_diff), sample(Easy),sample(Hard))
    RRs=c()
    RRs=c(RRs,cor(dat_p[,1],dat_p[,4]),cor(dat_p[,2],dat_p[,4]),cor(dat_p[,3],dat_p[,4]),cor(dat_p[,1],dat_p[,5]),cor(dat_p[,2],dat_p[,5]),cor(dat_p[,3],dat_p[,5]))
    T=c(T,sort(RRs,decreasing=FALSE)[s])
  }
  ASL=sum (T<=T0)/N_perm
T0
hist(T)
ASL



############################# Dane modyfikowane

set.seed(2)
dat=dat+matrix(rnorm(5*39)/10,39,5)

A=matrix(c(1,-0.01,-0.01,1),2,2)
d14=as.matrix(dat[,c(1,4)])
d14_=d14%*%A
dat <- data.frame(d14_[,1], N250_high_diff, N250_Joe_diff, d14_[,2],Hard)
names(dat)[1]='N250_low_diff'
names(dat)[4]='Easy'
cor(dat)

tiff(file = "fig2.tiff", width = 4000, height = 4000, units = "px", res = 300)
pairs.panels(dat,ellipse=FALSE,smooth=FALSE,breaks=12,cex.cor=0.4)
dev.off()





ggsave("fig2.jpeg", dpi=300)
dev.off()


jpeg("fig3.jpeg")
dev.off()

M = cor(dat)
corrplot(M, method = 'number') # colorful number




